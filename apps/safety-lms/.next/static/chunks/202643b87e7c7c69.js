(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52377,e=>{"use strict";e.s(["default",()=>eq],52377);var t=e.i(78196),r=e.i(49430),s=e.i(46257),a=e.i(41374),n=e.i(24924),l=e.i(11698),i=e.i(50399),c=e.i(83711),d=e.i(2708),o=e.i(13378);let u=(0,o.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var m=e.i(51034),x=e.i(87116),h=e.i(23701),p=e.i(80893);let f=(0,o.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);function g(e){let{courseTitle:r,modules:o,currentModuleId:g,overallProgress:j=0,className:b}=e;(0,s.usePathname)();let N=o.findIndex(e=>e.id===g),v=N>0?o[N-1]:null,y=N<o.length-1?o[N+1]:null;return(0,t.jsxs)(a.Card,{className:(0,c.cn)("h-fit",b),children:[(0,t.jsxs)(a.CardHeader,{className:"pb-4",children:[(0,t.jsx)(a.CardTitle,{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-100 line-clamp-2",children:r}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm text-neutral-600 dark:text-neutral-400",children:[(0,t.jsx)("span",{children:"Progress"}),(0,t.jsxs)("span",{className:"font-medium",children:[Math.round(j),"%"]})]}),(0,t.jsx)(l.Progress,{value:j,className:"h-2"})]})]}),(0,t.jsxs)(a.CardContent,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Course Modules"}),(0,t.jsx)("nav",{className:"space-y-2",children:o.map((e,r)=>{let s="video"===e.type?m.PlayCircle:h.FileText,a=(e=>{switch(e){case"completed":return d.CheckCircle;case"locked":return u;default:return null}})(e.status),n=e.id===g,o="locked"===e.status;return(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)(i.default,{href:o?"#":e.href,className:(0,c.cn)("flex items-start gap-3 p-3 rounded-lg transition-all duration-200","hover:bg-neutral-50 dark:hover:bg-neutral-800",n&&"bg-primary-50 dark:bg-primary-900/20 border border-primary-200 dark:border-primary-800",o&&"cursor-not-allowed opacity-60"),onClick:e=>o&&e.preventDefault(),children:(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,t.jsx)("div",{className:(0,c.cn)("flex-shrink-0 mt-0.5",(e=>{switch(e){case"completed":return"text-accent-green-600";case"in_progress":return"text-primary-600";case"locked":return"text-neutral-400";default:return"text-neutral-500"}})(e.status)),children:a?(0,t.jsx)(a,{className:"h-4 w-4"}):(0,t.jsx)(s,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-neutral-500 dark:text-neutral-400 bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded",children:r+1}),(0,t.jsx)("p",{className:(0,c.cn)("text-sm font-medium truncate",n&&"text-primary-600 dark:text-primary-400"),children:e.title})]}),e.description&&(0,t.jsx)("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 line-clamp-2 mb-2",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-3 text-xs text-neutral-500 dark:text-neutral-400",children:e.duration&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(x.Clock,{className:"h-3 w-3"}),e.duration]})}),void 0!==e.progress&&e.progress>0&&(0,t.jsxs)("div",{className:"text-xs font-medium text-neutral-600 dark:text-neutral-300",children:[e.progress,"%"]})]}),void 0!==e.progress&&e.progress>0&&e.progress<100&&(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(l.Progress,{value:e.progress,className:"h-1"})})]})]})})},e.id)})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-neutral-200 dark:border-neutral-700",children:[(0,t.jsx)(n.Button,{variant:"outline",size:"sm",disabled:!v||"locked"===v.status,asChild:!!v&&"locked"!==v.status,className:"flex items-center gap-2",children:v&&"locked"!==v.status?(0,t.jsxs)(i.default,{href:v.href,children:[(0,t.jsx)(f,{className:"h-4 w-4"}),"Previous"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f,{className:"h-4 w-4"}),"Previous"]})}),(0,t.jsx)(n.Button,{variant:"default",size:"sm",disabled:!y||"locked"===y.status,asChild:!!y&&"locked"!==y.status,className:"flex items-center gap-2",children:y&&"locked"!==y.status?(0,t.jsxs)(i.default,{href:y.href,children:["Next",(0,t.jsx)(p.ChevronRight,{className:"h-4 w-4"})]}):(0,t.jsxs)(t.Fragment,{children:["Next",(0,t.jsx)(p.ChevronRight,{className:"h-4 w-4"})]})})]})]})]})}var j=e.i(80441),b=e.i(97971),N=e.i(30218),v=e.i(27833);let y=(0,o.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var k=e.i(91780),w=e.i(22277),C=e.i(62639);let S=(0,o.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),E=(0,o.default)("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),I=(0,o.default)("quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]),q=(0,o.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var R=e.i(49119),T=e.i(91967),A=e.i(60751),z=e.i(66088),P=e.i(85355),B=e.i(463),M=e.i(41562),F=e.i(31323),L=e.i(52780),_=e.i(17545),D=e.i(68628),H="Radio",[Q,O]=(0,z.createContextScope)(H),[U,G]=Q(H),V=r.forwardRef((e,s)=>{let{__scopeRadio:a,name:n,checked:l=!1,required:i,disabled:c,value:d="on",onCheck:o,form:u,...m}=e,[x,h]=r.useState(null),p=(0,A.useComposedRefs)(s,e=>h(e)),f=r.useRef(!1),g=!x||u||!!x.closest("form");return(0,t.jsxs)(U,{scope:a,checked:l,disabled:c,children:[(0,t.jsx)(P.Primitive.button,{type:"button",role:"radio","aria-checked":l,"data-state":Y(l),"data-disabled":c?"":void 0,disabled:c,value:d,...m,ref:p,onClick:(0,T.composeEventHandlers)(e.onClick,e=>{l||null==o||o(),g&&(f.current=e.isPropagationStopped(),f.current||e.stopPropagation())})}),g&&(0,t.jsx)(J,{control:x,bubbles:!f.current,name:n,value:d,checked:l,required:i,disabled:c,form:u,style:{transform:"translateX(-100%)"}})]})});V.displayName=H;var K="RadioIndicator",X=r.forwardRef((e,r)=>{let{__scopeRadio:s,forceMount:a,...n}=e,l=G(K,s);return(0,t.jsx)(D.Presence,{present:a||l.checked,children:(0,t.jsx)(P.Primitive.span,{"data-state":Y(l.checked),"data-disabled":l.disabled?"":void 0,...n,ref:r})})});X.displayName=K;var J=r.forwardRef((e,s)=>{let{__scopeRadio:a,control:n,checked:l,bubbles:i=!0,...c}=e,d=r.useRef(null),o=(0,A.useComposedRefs)(d,s),u=(0,_.usePrevious)(l),m=(0,L.useSize)(n);return r.useEffect(()=>{let e=d.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(u!==l&&t){let r=new Event("click",{bubbles:i});t.call(e,l),e.dispatchEvent(r)}},[u,l,i]),(0,t.jsx)(P.Primitive.input,{type:"radio","aria-hidden":!0,defaultChecked:l,...c,tabIndex:-1,ref:o,style:{...c.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function Y(e){return e?"checked":"unchecked"}J.displayName="RadioBubbleInput";var W=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Z="RadioGroup",[$,ee]=(0,z.createContextScope)(Z,[B.createRovingFocusGroupScope,O]),et=(0,B.createRovingFocusGroupScope)(),er=O(),[es,ea]=$(Z),en=r.forwardRef((e,r)=>{let{__scopeRadioGroup:s,name:a,defaultValue:n,value:l,required:i=!1,disabled:c=!1,orientation:d,dir:o,loop:u=!0,onValueChange:m,...x}=e,h=et(s),p=(0,F.useDirection)(o),[f,g]=(0,M.useControllableState)({prop:l,defaultProp:null!=n?n:null,onChange:m,caller:Z});return(0,t.jsx)(es,{scope:s,name:a,required:i,disabled:c,value:f,onValueChange:g,children:(0,t.jsx)(B.Root,{asChild:!0,...h,orientation:d,dir:p,loop:u,children:(0,t.jsx)(P.Primitive.div,{role:"radiogroup","aria-required":i,"aria-orientation":d,"data-disabled":c?"":void 0,dir:p,...x,ref:r})})})});en.displayName=Z;var el="RadioGroupItem",ei=r.forwardRef((e,s)=>{let{__scopeRadioGroup:a,disabled:n,...l}=e,i=ea(el,a),c=i.disabled||n,d=et(a),o=er(a),u=r.useRef(null),m=(0,A.useComposedRefs)(s,u),x=i.value===l.value,h=r.useRef(!1);return r.useEffect(()=>{let e=e=>{W.includes(e.key)&&(h.current=!0)},t=()=>h.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[]),(0,t.jsx)(B.Item,{asChild:!0,...d,focusable:!c,active:x,children:(0,t.jsx)(V,{disabled:c,required:i.required,checked:x,...o,...l,name:i.name,ref:m,onCheck:()=>i.onValueChange(l.value),onKeyDown:(0,T.composeEventHandlers)(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:(0,T.composeEventHandlers)(l.onFocus,()=>{var e;h.current&&(null==(e=u.current)||e.click())})})})});ei.displayName=el;var ec=r.forwardRef((e,r)=>{let{__scopeRadioGroup:s,...a}=e,n=er(s);return(0,t.jsx)(X,{...n,...a,ref:r})});ec.displayName="RadioGroupIndicator";var ed=e.i(70899);let eo=r.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(en,{className:(0,c.cn)("grid gap-2",s),...a,ref:r})});eo.displayName=en.displayName;let eu=r.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(ei,{ref:r,className:(0,c.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:(0,t.jsx)(ec,{className:"flex items-center justify-center",children:(0,t.jsx)(ed.Circle,{className:"h-2.5 w-2.5 fill-current text-current"})})})});eu.displayName=ei.displayName;var em=e.i(73089),ex=e.i(36660);let eh=e=>e?e.replace(/\\\\n\\\\n/g,"\n\n").replace(/\\\\n/g,"\n").replace(/\\n\\n/g,"\n\n").replace(/\\n/g,"\n"):e;function ep(e){let{content:r,metadata:s}=e,{badge:a,title:n,subtitle:l}=r,i=(null==s?void 0:s.background)==="gradient-blue"?"bg-gradient-to-r from-blue-600 to-blue-800":"bg-gradient-to-r from-gray-600 to-gray-800";return(0,t.jsxs)("div",{className:"".concat(i," text-white rounded-lg p-8 mb-6"),children:[a&&(0,t.jsx)(w.Badge,{variant:"secondary",className:"mb-4 bg-white/20 text-white border-white/30",children:a}),(0,t.jsx)("h1",{className:"text-3xl font-bold mb-2",children:n}),l&&(0,t.jsx)("p",{className:"text-xl opacity-90",children:l})]})}function ef(e){let{content:r}=e;return(0,t.jsx)("div",{className:"prose prose-gray dark:prose-invert max-w-none mb-6",children:(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:eh(r.content).replace(/\n/g,"<br>")}})})}function eg(e){let{content:r,metadata:s}=e,{title:n,description:l,items:i}=r;return(0,t.jsxs)(a.Card,{className:"mb-6",children:[(0,t.jsxs)(a.CardHeader,{children:[n&&(0,t.jsx)(a.CardTitle,{children:n}),l&&(0,t.jsx)("p",{className:"text-muted-foreground",children:l})]}),i&&(0,t.jsx)(a.CardContent,{children:(0,t.jsx)("div",{className:"grid gap-4",children:i.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:e.title}),e.description&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]})]},r))})})]})}function ej(e){let{content:r,metadata:s}=e,{src:a,alt:n,caption:l}=r;return(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("img",{src:a,alt:n||"",className:"w-full rounded-lg shadow-sm",loading:"lazy"}),l&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:l})]})}function eb(e){let{content:r}=e,{headers:s,rows:a}=r;return(0,t.jsx)("div",{className:"mb-6 overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full border-collapse border border-border",children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{className:"bg-muted",children:s.map((e,r)=>(0,t.jsx)("th",{className:"border border-border p-3 text-left font-medium",children:e},r))})}),(0,t.jsx)("tbody",{children:a.map((e,r)=>(0,t.jsx)("tr",{className:"hover:bg-muted/50",children:e.map((e,r)=>(0,t.jsx)("td",{className:"border border-border p-3",children:e},r))},r))})]})})}function eN(e){let{content:r,metadata:s}=e,{items:a,type:n="unordered"}=r;return(0,t.jsx)("div",{className:"mb-6",children:"ordered"===n?(0,t.jsx)("ol",{className:"list-decimal list-inside space-y-2",children:a.map((e,r)=>(0,t.jsx)("li",{className:"text-foreground",children:e},r))}):(0,t.jsx)("ul",{className:"list-disc list-inside space-y-2",children:a.map((e,r)=>(0,t.jsx)("li",{className:"text-foreground",children:e},r))})})}function ev(e){let{content:r,metadata:s}=e,{items:n,columns:l=2}=r;return(0,t.jsx)("div",{className:"grid ".concat(3===l?"grid-cols-1 md:grid-cols-3":4===l?"grid-cols-1 md:grid-cols-2 lg:grid-cols-4":"grid-cols-1 md:grid-cols-2"," gap-4 mb-6"),children:n.map((e,r)=>(0,t.jsx)(a.Card,{className:"p-4",children:(0,t.jsxs)(a.CardContent,{className:"p-0",children:[e.title&&(0,t.jsx)("h4",{className:"font-medium mb-2",children:e.title}),e.content&&(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:eh(e.content).replace(/\n/g,"<br>")}})}),e.image&&(0,t.jsx)("img",{src:e.image,alt:e.title||"",className:"w-full rounded mt-2"})]})},r))})}function ey(e){let{content:r,metadata:s}=e,{title:a,content:n}=r,l=(null==s?void 0:s.type)||"info",i=()=>{switch(l){case"warning":return"text-yellow-800 dark:text-yellow-200";case"error":return"text-red-800 dark:text-red-200";case"success":return"text-green-800 dark:text-green-200";case"tip":return"text-blue-800 dark:text-blue-200";default:return"text-gray-800 dark:text-gray-200"}};return(0,t.jsx)("div",{className:"".concat((()=>{switch(l){case"warning":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800";case"error":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800";case"success":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800";case"tip":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800";default:return"bg-gray-50 dark:bg-gray-900/20 border-gray-200 dark:border-gray-800"}})()," border rounded-lg p-4 mb-6"),children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"".concat(i()," mt-0.5"),children:(()=>{switch(l){case"warning":return(0,t.jsx)(C.AlertTriangle,{className:"h-5 w-5"});case"error":return(0,t.jsx)(y,{className:"h-5 w-5"});case"success":return(0,t.jsx)(d.CheckCircle,{className:"h-5 w-5"});case"tip":return(0,t.jsx)(E,{className:"h-5 w-5"});default:return(0,t.jsx)(S,{className:"h-5 w-5"})}})()}),(0,t.jsxs)("div",{className:"flex-1",children:[a&&(0,t.jsx)("h4",{className:"font-medium ".concat(i()," mb-2"),children:a}),(0,t.jsx)("div",{className:"".concat(i()," whitespace-pre-line"),children:(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:eh(n).replace(/\n/g,"<br>")}})})]})]})})}function ek(e){let{content:r,metadata:s}=e,{quote:a,author:n,title:l}=r;return(0,t.jsxs)("div",{className:"border-l-4 border-primary bg-muted/30 rounded-r-lg p-6 mb-6",children:[(0,t.jsxs)("blockquote",{className:"text-lg italic mb-4",children:['"',a,'"']}),n&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(I,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:n}),l&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:l})]})]})]})}function ew(e){let{metadata:r}=e,s=(null==r?void 0:r.style)||"default";return"dotted"===s?(0,t.jsx)("div",{className:"border-t-2 border-dotted border-border my-6"}):"thick"===s?(0,t.jsx)("div",{className:"border-t-4 border-border my-6"}):(0,t.jsx)("div",{className:"border-t border-border my-6"})}function eC(e){let{content:r,metadata:s}=e,{src:a,title:n,description:l}=r;return(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("div",{className:"relative w-full h-0 pb-[56.25%] bg-black rounded-lg overflow-hidden",children:(0,t.jsxs)("video",{className:"absolute top-0 left-0 w-full h-full",controls:!0,preload:"metadata",children:[(0,t.jsx)("source",{src:a,type:"video/mp4"}),"Your browser does not support the video tag."]})}),n&&(0,t.jsx)("h4",{className:"font-medium mt-2",children:n}),l&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:l})]})}function eS(e){let{content:r,metadata:s}=e,{src:a,title:n,description:l}=r;return(0,t.jsxs)("div",{className:"mb-6 p-4 border rounded-lg",children:[(0,t.jsxs)("audio",{controls:!0,className:"w-full mb-2",children:[(0,t.jsx)("source",{src:a,type:"audio/mpeg"}),"Your browser does not support the audio tag."]}),n&&(0,t.jsx)("h4",{className:"font-medium",children:n}),l&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:l})]})}function eE(e){let{content:s,metadata:a,sectionId:l,onInteraction:i}=e,{user:c}=(0,ex.useAuth)(),{updateProgress:o}=function(e){let{user:t}=(0,ex.useAuth)(),[s,a]=(0,r.useState)(null),[n,l]=(0,r.useState)(!0),[i,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{if(!(null==t?void 0:t.id)||!e)return l(!1);try{var r;l(!0),c(null);let t=await fetch("/api/quiz-questions?sectionId=".concat(e));if(!t.ok)throw Error("Failed to fetch quiz questions");let s=await t.json();if(!s.success||!s.data){a({sectionId:e,totalQuestions:0,completedQuestions:0,correctAnswers:0,isCompleted:!1}),l(!1);return}let n=s.data,i=n.length,d=await fetch("/api/quiz-attempts");if(!d.ok){console.error("Failed to fetch quiz attempts:",d.status,d.statusText),a({sectionId:e,totalQuestions:i,completedQuestions:0,correctAnswers:0,isCompleted:!1}),l(!1);return}let o=await d.json();if(!o.success||!o.data){console.log("No quiz attempts found for user"),a({sectionId:e,totalQuestions:i,completedQuestions:0,correctAnswers:0,isCompleted:!1}),l(!1);return}let u=o.data,m=n.map(e=>e.id),x=new Map;u.forEach(e=>{if(m.includes(e.quizQuestionId)){let t=x.get(e.quizQuestionId);(!t||new Date(e.attemptedAt)>new Date(t.attemptedAt))&&x.set(e.quizQuestionId,e)}});let h=x.size,p=Array.from(x.values()).filter(e=>e.isCorrect).length,f=null==(r=Array.from(x.values()).sort((e,t)=>new Date(t.attemptedAt).getTime()-new Date(e.attemptedAt).getTime())[0])?void 0:r.attemptedAt;a({sectionId:e,totalQuestions:i,completedQuestions:h,correctAnswers:p,isCompleted:h===i&&i>0,lastAttemptAt:f})}catch(e){console.error("Error fetching knowledge check progress:",e),c(e instanceof Error?e.message:"Failed to fetch progress")}finally{l(!1)}})()},[null==t?void 0:t.id,e]);let d=async()=>{(null==t?void 0:t.id)&&e&&(l(!0),(async()=>{try{var t;let r=await fetch("/api/quiz-questions?sectionId=".concat(e));if(!r.ok)return;let s=await r.json();if(!s.success||!s.data)return;let n=s.data,l=n.length,i=await fetch("/api/quiz-attempts");if(!i.ok)return void console.error("Failed to fetch quiz attempts in updateProgress:",i.status);let c=await i.json();if(!c.success||!c.data)return void console.log("No quiz attempts found for user in updateProgress");let d=c.data,o=n.map(e=>e.id),u=new Map;d.forEach(e=>{if(o.includes(e.quizQuestionId)){let t=u.get(e.quizQuestionId);(!t||new Date(e.attemptedAt)>new Date(t.attemptedAt))&&u.set(e.quizQuestionId,e)}});let m=u.size,x=Array.from(u.values()).filter(e=>e.isCorrect).length,h=null==(t=Array.from(u.values()).sort((e,t)=>new Date(t.attemptedAt).getTime()-new Date(e.attemptedAt).getTime())[0])?void 0:t.attemptedAt;a({sectionId:e,totalQuestions:l,completedQuestions:m,correctAnswers:x,isCompleted:m===l&&l>0,lastAttemptAt:h})}catch(e){console.error("Error updating progress:",e)}finally{l(!1)}})())};return{progress:s,loading:n,error:i,updateProgress:d,refetch:d}}(l),[u,m]=r.default.useState(""),[x,h]=r.default.useState(!1),[p,f]=r.default.useState(null),[g,j]=r.default.useState(0),[b,N]=r.default.useState(!1),{questionText:v,options:y,correctAnswer:k,explanation:w,quizQuestionId:C}=s,S="string"==typeof y?JSON.parse(y):y;r.default.useEffect(()=>{(async()=>{if((null==c?void 0:c.id)&&C)try{let e=await fetch("/api/quiz-attempts?userId=".concat(encodeURIComponent(c.id),"&quizQuestionId=").concat(encodeURIComponent(C)));if(e.ok){let t=await e.json();if(t.success&&t.data.length>0){let e=t.data[0];m(e.user_answer),h(!0),f(e.is_correct),N(!0),j(t.data.length)}}}catch(e){console.error("Error loading quiz attempts:",e)}})()},[null==c?void 0:c.id,C]);let I=async()=>{if(!u||!(null==c?void 0:c.id)||!C)return;let e=k.split(",").map(e=>e.trim()).includes(u);f(e),h(!0),N(!0),j(e=>e+1);try{let t=await fetch("/api/quiz-attempts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:c.id,quizQuestionId:C,userAnswer:u,isCorrect:e,timeSpent:0})});t.ok&&(await t.json()).success&&(await o(),i&&i({blockId:s.id||"knowledge-check",interactionType:"click",metadata:{action:"submit_answer",isCorrect:e,attempts:g+1}}))}catch(e){console.error("Error recording quiz attempt:",e)}};return(0,t.jsxs)("div",{className:"".concat(x&&null!==p?p?"border-green-200 bg-green-50 dark:bg-green-900/20":"border-red-200 bg-red-50 dark:bg-red-900/20":"border-blue-200 bg-blue-50 dark:bg-blue-900/20"," border rounded-lg p-6 mb-6"),children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,t.jsx)("div",{className:"text-blue-800 dark:text-blue-200 mt-0.5",children:(0,t.jsx)(E,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Knowledge Check"}),(0,t.jsx)("div",{className:"text-blue-800 dark:text-blue-200 text-sm leading-relaxed",children:(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:eh(v).replace(/\n/g,"<br>")}})})]})]}),(0,t.jsx)("div",{className:"space-y-3 mb-6",children:(0,t.jsx)(eo,{value:u,onValueChange:e=>{x||m(e)},disabled:x,className:"space-y-3",children:Object.entries(S).map(e=>{let[r,s]=e;return(0,t.jsxs)("div",{className:(e=>{let t="flex items-center space-x-3 p-4 rounded-lg border transition-colors cursor-pointer";if(x){let r=k.split(",").map(e=>e.trim()).includes(e),s=u===e;r?t+=" border-green-300 bg-green-50 dark:bg-green-900/20":s&&!r?t+=" border-red-300 bg-red-50 dark:bg-red-900/20":t+=" border-gray-200 bg-gray-50 dark:bg-gray-900/20"}else u===e?t+=" border-primary bg-primary/5":t+=" border-border hover:border-primary/50";return t})(r),children:[(0,t.jsx)(eu,{value:r,id:r,className:"flex-shrink-0"}),(0,t.jsx)(em.Label,{htmlFor:r,className:"flex-1 cursor-pointer font-normal",children:"string"==typeof s?s:"".concat(r.toUpperCase(),". ").concat(s)}),x&&k.split(",").map(e=>e.trim()).includes(r)&&(0,t.jsx)(d.CheckCircle,{className:"h-5 w-5 text-green-500 flex-shrink-0"}),x&&u===r&&!k.split(",").map(e=>e.trim()).includes(r)&&(0,t.jsx)(R.XCircle,{className:"h-5 w-5 text-red-500 flex-shrink-0"})]},r)})})}),b&&(0,t.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,t.jsxs)("div",{className:"p-4 rounded-lg ".concat(p?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[p?(0,t.jsx)(d.CheckCircle,{className:"h-5 w-5 text-green-500"}):(0,t.jsx)(R.XCircle,{className:"h-5 w-5 text-red-500"}),(0,t.jsx)("span",{className:"font-medium ".concat(p?"text-green-800 dark:text-green-200":"text-red-800 dark:text-red-200"),children:p?"Correct!":"Incorrect"})]}),!p&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mb-2",children:["The correct answer",k.includes(",")?"s are":" is",":"," ",(0,t.jsx)("span",{className:"font-medium",children:k.split(",").map(e=>S[e.trim()]).join(", ")})]})]}),w&&(0,t.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Explanation"}),(0,t.jsx)("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:eh(w).replace(/\n/g,"<br>")}})})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-blue-200 dark:border-blue-800",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:x&&!p&&(0,t.jsxs)(n.Button,{variant:"outline",onClick:()=>{m(""),h(!1),f(null),N(!1)},className:"flex items-center gap-2",children:[(0,t.jsx)(q,{className:"h-4 w-4"}),"Try Again"]})}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:x?(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:p?"Great job!":"Keep learning!"}):(0,t.jsx)(n.Button,{onClick:I,disabled:!u,className:"flex items-center gap-2",children:"Submit Answer"})})]})]})}function eI(e){let{block:r,sectionId:s,onInteraction:a}=e;return(0,t.jsx)("div",{className:"content-block","data-block-id":r.id,onMouseEnter:()=>{a&&a({blockId:r.id,interactionType:"view",metadata:void 0})},children:(()=>{switch(r.block_type){case"hero":return(0,t.jsx)(ep,{content:r.content,metadata:r.metadata});case"text":return(0,t.jsx)(ef,{content:r.content});case"card":return(0,t.jsx)(eg,{content:r.content,metadata:r.metadata});case"image":return(0,t.jsx)(ej,{content:r.content,metadata:r.metadata});case"table":return(0,t.jsx)(eb,{content:r.content});case"list":return(0,t.jsx)(eN,{content:r.content,metadata:r.metadata});case"grid":return(0,t.jsx)(ev,{content:r.content,metadata:r.metadata});case"callout":return(0,t.jsx)(ey,{content:r.content,metadata:r.metadata});case"quote":return(0,t.jsx)(ek,{content:r.content,metadata:r.metadata});case"divider":return(0,t.jsx)(ew,{metadata:r.metadata});case"video":return(0,t.jsx)(eC,{content:r.content,metadata:r.metadata});case"audio":return(0,t.jsx)(eS,{content:r.content,metadata:r.metadata});case"knowledge-check":return(0,t.jsx)(eE,{content:r.content,metadata:r.metadata,sectionId:s,onInteraction:a});default:return(0,t.jsx)("div",{className:"mb-6 p-4 border border-dashed border-muted-foreground rounded-lg",children:(0,t.jsxs)("p",{className:"text-muted-foreground text-center",children:["Unsupported block type: ",r.block_type]})})}})()})}function eq(){let e=(0,s.useParams)(),i=(0,s.useRouter)(),{courses:c,loading:d}=(0,k.useCourses)(),o=e.slug,u=e.sectionId,p=c.find(e=>e.slug===o),{sections:f,loading:w,error:C}=function(e){let[t,s]=(0,r.useState)([]),[a,n]=(0,r.useState)(!0),[l,i]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{if(!e)return n(!1);try{n(!0),i(null);let t=await fetch("/api/courses/".concat(e,"/sections"));if(!t.ok)throw Error("Failed to fetch sections: ".concat(t.statusText));let r=await t.json();if(!r.success)throw Error(r.error||"Failed to fetch sections");s(r.data||[])}catch(e){console.error("Error fetching course sections:",e),i(e instanceof Error?e.message:"Failed to fetch sections")}finally{n(!1)}})()},[e]),{sections:t,loading:a,error:l}}(o),{contentBlocks:S,loading:E,error:I}=function(e,t){let[s,a]=(0,r.useState)([]),[n,l]=(0,r.useState)(!0),[i,c]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{if(!e||!t)return l(!1);try{l(!0),c(null);let r=await fetch("/api/courses/".concat(e,"/sections/").concat(t,"/content"));if(!r.ok)throw Error("Failed to fetch content blocks: ".concat(r.statusText));let s=await r.json();if(!s.success)throw Error(s.error||"Failed to fetch content blocks");a(s.data||[])}catch(e){console.error("Error fetching content blocks:",e),c(e instanceof Error?e.message:"Failed to fetch content blocks")}finally{l(!1)}})()},[e,t]),{contentBlocks:s,loading:n,error:i}}(o,u),q=f.find(e=>e.id===u),R=f.findIndex(e=>e.id===u),T=r.useMemo(()=>f.map((e,t)=>({id:e.id,title:e.title,description:"Section ".concat(t+1," of the ").concat((null==p?void 0:p.title)||"course"),duration:"30 minutes",type:"reading",status:t<R?"completed":t===R?"in_progress":"available",progress:100*(t<R),href:"/courses/".concat(o,"/learn/").concat(e.id)})),[f,p,o,R]),A=r.useMemo(()=>{if(0===T.length)return 0;let e=T.filter(e=>"completed"===e.status).length,t=T.filter(e=>"in_progress"===e.status).length,r=T.length;return e/r*100+t/r*50},[T]);if(d||w||E)return(0,t.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,t.jsx)(v.Loader2,{className:"h-8 w-8 animate-spin text-primary-600"}),(0,t.jsx)("span",{className:"ml-3 text-neutral-600",children:"Loading course content..."})]});if(C||I)return(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(y,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium mb-2 text-neutral-900 dark:text-neutral-100",children:"Error Loading Course"}),(0,t.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400 mb-4",children:C||I}),(0,t.jsx)(n.Button,{onClick:()=>i.push("/courses"),children:"Back to Courses"})]});if(!p)return(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(j.BookOpen,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium mb-2 text-neutral-900 dark:text-neutral-100",children:"Course Not Found"}),(0,t.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400 mb-4",children:"The course you're looking for doesn't exist or has been removed."}),(0,t.jsx)(n.Button,{onClick:()=>i.push("/courses"),children:"Back to Courses"})]});if(!q)return(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(j.BookOpen,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium mb-2 text-neutral-900 dark:text-neutral-100",children:"Section Not Found"}),(0,t.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400 mb-4",children:"The section you're looking for doesn't exist or has been removed."}),(0,t.jsx)(n.Button,{onClick:()=>i.push("/courses/".concat(o,"/learn")),children:"Back to Course"})]});if(0===S.length)return(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(j.BookOpen,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium mb-2 text-neutral-900 dark:text-neutral-100",children:"Content Coming Soon"}),(0,t.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400 mb-4",children:"This section doesn't have any content yet. Content is being prepared."}),(0,t.jsx)(n.Button,{onClick:()=>i.push("/courses/".concat(o,"/learn")),children:"Back to Course"})]});let z=f[R+1],P=f[R-1];return(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsx)("div",{className:"sticky top-8",children:(0,t.jsx)(g,{courseTitle:p.title,modules:T,currentModuleId:q.id,overallProgress:A})})}),(0,t.jsxs)("div",{className:"lg:col-span-3 space-y-8",children:[(0,t.jsx)("div",{className:"flex items-center gap-4 mb-6",children:(0,t.jsxs)(n.Button,{variant:"ghost",size:"sm",onClick:()=>i.push("/courses/".concat(o,"/learn")),className:"flex items-center gap-2",children:[(0,t.jsx)(b.ArrowLeft,{className:"h-4 w-4"}),"Back to Course"]})}),(0,t.jsxs)(a.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(m.PlayCircle,{className:"h-6 w-6 text-primary-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(a.CardTitle,{className:"text-neutral-900 dark:text-neutral-100",children:q.title}),(0,t.jsxs)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mt-1",children:["Section ",R+1," of ",f.length," • Reading • 30 minutes"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-neutral-600 dark:text-neutral-400",children:[(0,t.jsx)(x.Clock,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"30 minutes remaining"})]})]})}),(0,t.jsxs)(a.CardContent,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Section Progress"}),(0,t.jsx)("span",{className:"font-medium text-neutral-900 dark:text-neutral-100",children:"0%"})]}),(0,t.jsx)(l.Progress,{value:0,className:"h-2"})]}),(0,t.jsx)("div",{className:"space-y-6",children:S.map((e,r)=>(0,t.jsx)(eI,{block:e,sectionId:u,onInteraction:e=>{console.log("Content interaction:",e)}},e.id))}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-neutral-200 dark:border-neutral-700",children:[(0,t.jsxs)(n.Button,{variant:"outline",disabled:!P,onClick:()=>P&&i.push("/courses/".concat(o,"/learn/").concat(P.id)),className:"flex items-center gap-2",children:[(0,t.jsx)(b.ArrowLeft,{className:"h-4 w-4"}),"Previous Section"]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(n.Button,{variant:"outline",className:"flex items-center gap-2",children:[(0,t.jsx)(h.FileText,{className:"h-4 w-4"}),"Take Notes"]}),(0,t.jsxs)(n.Button,{onClick:()=>z?i.push("/courses/".concat(o,"/learn/").concat(z.id)):i.push("/courses/".concat(o)),className:"flex items-center gap-2",children:[z?"Next Section":"Complete Course",(0,t.jsx)(N.ArrowRight,{className:"h-4 w-4"})]})]})]})]})]})]})]})}}]);