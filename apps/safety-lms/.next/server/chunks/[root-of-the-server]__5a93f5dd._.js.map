{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jshepherd/OneDrive%20-%20SpecChem%2C%20LLC/Desktop/specchem-safety-lms-v2-main/apps/safety-lms/src/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient, type CookieOptions } from \"@supabase/ssr\";\nimport { cookies } from \"next/headers\";\nimport { cache } from \"react\";\n\nexport const createClient = cache(async () => {\n  const cookieStore = await cookies();\n\n  return createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        get(name: string) {\n          return cookieStore.get(name)?.value;\n        },\n        set(name: string, value: string, options: CookieOptions) {\n          try {\n            cookieStore.set({ name, value, ...options });\n          } catch (error) {\n            // The `cookies().set()` method can only be called from a Server Component or Server Action.\n            // This error can be ignored if you are running tests that don't have a Server Component.\n          }\n        },\n        remove(name: string, options: CookieOptions) {\n          try {\n            cookieStore.set({ name, value: \"\", ...options });\n          } catch (error) {\n            // The `cookies().set()` method can only be called from a Server Component or Server Action.\n            // This error can be ignored if you are running tests that don't have a Server Component.\n          }\n        },\n      },\n    }\n  );\n});\n\n// Legacy export for backward compatibility\nexport const createServerSupabaseClient = createClient;\n\n// Server auth helper for API routes\nexport const serverAuth = {\n  async getCurrentUser() {\n    const supabase = await createClient();\n    const { data: { user }, error } = await supabase.auth.getUser();\n\n    if (error || !user) {\n      return { user: null, profile: null };\n    }\n\n    // Get user profile from profiles table\n    const { data: profile, error: profileError } = await supabase\n      .from(\"profiles\")\n      .select(\"*\")\n      .eq(\"auth_user_id\", user.id)\n      .single();\n\n    if (profileError) {\n      console.error(\"Error fetching user profile:\", profileError);\n      return { user, profile: null };\n    }\n\n    return { user, profile };\n  }\n};\n"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;AACA;AACA;;;;AAEO,MAAM,eAAe,IAAA,+UAAK,EAAC;IAChC,MAAM,cAAc,MAAM,IAAA,2QAAO;IAEjC,OAAO,IAAA,8SAAkB,sUAGvB;QACE,SAAS;YACP,KAAI,IAAY;gBACd,OAAO,YAAY,GAAG,CAAC,OAAO;YAChC;YACA,KAAI,IAAY,EAAE,KAAa,EAAE,OAAsB;gBACrD,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM;wBAAO,GAAG,OAAO;oBAAC;gBAC5C,EAAE,OAAO,OAAO;gBACd,4FAA4F;gBAC5F,yFAAyF;gBAC3F;YACF;YACA,QAAO,IAAY,EAAE,OAAsB;gBACzC,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM,OAAO;wBAAI,GAAG,OAAO;oBAAC;gBAChD,EAAE,OAAO,OAAO;gBACd,4FAA4F;gBAC5F,yFAAyF;gBAC3F;YACF;QACF;IACF;AAEJ;AAGO,MAAM,6BAA6B;AAGnC,MAAM,aAAa;IACxB,MAAM;QACJ,MAAM,WAAW,MAAM;QACvB,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAE7D,IAAI,SAAS,CAAC,MAAM;YAClB,OAAO;gBAAE,MAAM;gBAAM,SAAS;YAAK;QACrC;QAEA,uCAAuC;QACvC,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,SAClD,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,gBAAgB,KAAK,EAAE,EAC1B,MAAM;QAET,IAAI,cAAc;YAChB,QAAQ,KAAK,CAAC,gCAAgC;YAC9C,OAAO;gBAAE;gBAAM,SAAS;YAAK;QAC/B;QAEA,OAAO;YAAE;YAAM;QAAQ;IACzB;AACF","debugId":null}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jshepherd/OneDrive%20-%20SpecChem%2C%20LLC/Desktop/specchem-safety-lms-v2-main/apps/safety-lms/src/app/api/courses/%5Bslug%5D/sections/%5BsectionId%5D/content/route.ts"],"sourcesContent":["import { createClient } from \"@/lib/supabase/server\";\r\nimport { NextResponse } from \"next/server\";\r\n\r\nexport const dynamic = \"force-dynamic\";\r\n\r\nexport async function GET(\r\n  request: Request,\r\n  { params }: { params: Promise<{ slug: string; sectionId: string }> }\r\n) {\r\n  try {\r\n    const supabase = await createClient();\r\n    const { slug, sectionId } = await params;\r\n\r\n    // First, get the course by slug\r\n    const { data: course, error: courseError } = await supabase\r\n      .from(\"courses\")\r\n      .select(\"id\")\r\n      .eq(\"slug\", slug)\r\n      .single();\r\n\r\n    if (courseError || !course) {\r\n      return NextResponse.json(\r\n        { success: false, error: \"Course not found\" },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    // Verify the section belongs to this course\r\n    const { data: section, error: sectionError } = await supabase\r\n      .from(\"course_sections\")\r\n      .select(\"id\")\r\n      .eq(\"id\", sectionId)\r\n      .eq(\"course_id\", course.id)\r\n      .single();\r\n\r\n    if (sectionError || !section) {\r\n      return NextResponse.json(\r\n        { success: false, error: \"Section not found\" },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    // Get content blocks for this section\r\n    const { data: contentBlocks, error: contentBlocksError } = await supabase\r\n      .from(\"content_blocks\")\r\n      .select(\"*\")\r\n      .eq(\"section_id\", sectionId)\r\n      .order(\"order_index\", { ascending: true });\r\n\r\n    if (contentBlocksError) {\r\n      console.error(\"Error fetching content blocks:\", contentBlocksError);\r\n      return NextResponse.json(\r\n        { success: false, error: \"Failed to fetch content blocks\" },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      data: contentBlocks || [],\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error in content blocks API:\", error);\r\n    return NextResponse.json(\r\n      {\r\n        success: false,\r\n        error: error instanceof Error ? error.message : \"Internal server error\",\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,MAAM,UAAU;AAEhB,eAAe,IACpB,OAAgB,EAChB,EAAE,MAAM,EAA4D;IAEpE,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,2KAAY;QACnC,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,MAAM;QAElC,gCAAgC;QAChC,MAAM,EAAE,MAAM,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,SAChD,IAAI,CAAC,WACL,MAAM,CAAC,MACP,EAAE,CAAC,QAAQ,MACX,MAAM;QAET,IAAI,eAAe,CAAC,QAAQ;YAC1B,OAAO,+QAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAmB,GAC5C;gBAAE,QAAQ;YAAI;QAElB;QAEA,4CAA4C;QAC5C,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,SAClD,IAAI,CAAC,mBACL,MAAM,CAAC,MACP,EAAE,CAAC,MAAM,WACT,EAAE,CAAC,aAAa,OAAO,EAAE,EACzB,MAAM;QAET,IAAI,gBAAgB,CAAC,SAAS;YAC5B,OAAO,+QAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAoB,GAC7C;gBAAE,QAAQ;YAAI;QAElB;QAEA,sCAAsC;QACtC,MAAM,EAAE,MAAM,aAAa,EAAE,OAAO,kBAAkB,EAAE,GAAG,MAAM,SAC9D,IAAI,CAAC,kBACL,MAAM,CAAC,KACP,EAAE,CAAC,cAAc,WACjB,KAAK,CAAC,eAAe;YAAE,WAAW;QAAK;QAE1C,IAAI,oBAAoB;YACtB,QAAQ,KAAK,CAAC,kCAAkC;YAChD,OAAO,+QAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAiC,GAC1D;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,+QAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM,iBAAiB,EAAE;QAC3B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO,+QAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAClD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}