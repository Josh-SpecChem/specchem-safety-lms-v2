module.exports=[58323,a=>{"use strict";a.s(["default",()=>aD],58323);var b=a.i(11755),c=a.i(80150),d=a.i(30718),e=a.i(849),f=a.i(81953),g=a.i(49785),h=a.i(78352),i=a.i(80511),j=a.i(41120),k=a.i(21211);let l=(0,k.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var m=a.i(73623),n=a.i(31637),o=a.i(6889),p=a.i(50916);let q=(0,k.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);function r({courseTitle:a,modules:c,currentModuleId:k,overallProgress:r=0,className:s}){(0,d.usePathname)();let t=c.findIndex(a=>a.id===k),u=t>0?c[t-1]:null,v=t<c.length-1?c[t+1]:null;return(0,b.jsxs)(e.Card,{className:(0,i.cn)("h-fit",s),children:[(0,b.jsxs)(e.CardHeader,{className:"pb-4",children:[(0,b.jsx)(e.CardTitle,{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-100 line-clamp-2",children:a}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm text-neutral-600 dark:text-neutral-400",children:[(0,b.jsx)("span",{children:"Progress"}),(0,b.jsxs)("span",{className:"font-medium",children:[Math.round(r),"%"]})]}),(0,b.jsx)(g.Progress,{value:r,className:"h-2"})]})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Course Modules"}),(0,b.jsx)("nav",{className:"space-y-2",children:c.map((a,c)=>{let d="video"===a.type?m.PlayCircle:o.FileText,e=(a=>{switch(a){case"completed":return j.CheckCircle;case"locked":return l;default:return null}})(a.status),f=a.id===k,p="locked"===a.status;return(0,b.jsx)("div",{className:"relative",children:(0,b.jsx)(h.default,{href:p?"#":a.href,className:(0,i.cn)("flex items-start gap-3 p-3 rounded-lg transition-all duration-200","hover:bg-neutral-50 dark:hover:bg-neutral-800",f&&"bg-primary-50 dark:bg-primary-900/20 border border-primary-200 dark:border-primary-800",p&&"cursor-not-allowed opacity-60"),onClick:a=>p&&a.preventDefault(),children:(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,b.jsx)("div",{className:(0,i.cn)("flex-shrink-0 mt-0.5",(a=>{switch(a){case"completed":return"text-accent-green-600";case"in_progress":return"text-primary-600";case"locked":return"text-neutral-400";default:return"text-neutral-500"}})(a.status)),children:e?(0,b.jsx)(e,{className:"h-4 w-4"}):(0,b.jsx)(d,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-neutral-500 dark:text-neutral-400 bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded",children:c+1}),(0,b.jsx)("p",{className:(0,i.cn)("text-sm font-medium truncate",f&&"text-primary-600 dark:text-primary-400"),children:a.title})]}),a.description&&(0,b.jsx)("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 line-clamp-2 mb-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"flex items-center gap-3 text-xs text-neutral-500 dark:text-neutral-400",children:a.duration&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(n.Clock,{className:"h-3 w-3"}),a.duration]})}),void 0!==a.progress&&a.progress>0&&(0,b.jsxs)("div",{className:"text-xs font-medium text-neutral-600 dark:text-neutral-300",children:[a.progress,"%"]})]}),void 0!==a.progress&&a.progress>0&&a.progress<100&&(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)(g.Progress,{value:a.progress,className:"h-1"})})]})]})})},a.id)})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-neutral-200 dark:border-neutral-700",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",disabled:!u||"locked"===u.status,asChild:!!u&&"locked"!==u.status,className:"flex items-center gap-2",children:u&&"locked"!==u.status?(0,b.jsxs)(h.default,{href:u.href,children:[(0,b.jsx)(q,{className:"h-4 w-4"}),"Previous"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q,{className:"h-4 w-4"}),"Previous"]})}),(0,b.jsx)(f.Button,{variant:"default",size:"sm",disabled:!v||"locked"===v.status,asChild:!!v&&"locked"!==v.status,className:"flex items-center gap-2",children:v&&"locked"!==v.status?(0,b.jsxs)(h.default,{href:v.href,children:["Next",(0,b.jsx)(p.ChevronRight,{className:"h-4 w-4"})]}):(0,b.jsxs)(b.Fragment,{children:["Next",(0,b.jsx)(p.ChevronRight,{className:"h-4 w-4"})]})})]})]})]})}var s=a.i(30898),t=a.i(57994),u=a.i(11305),v=a.i(37100);let w=(0,k.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var x=a.i(79094),y=a.i(18550),z=a.i(25476);let A=(0,k.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),B=(0,k.default)("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),C=(0,k.default)("quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]),D=(0,k.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var E=a.i(52856),F=a.i(59653),G=a.i(29739),H=a.i(59348),I=a.i(10574),J=a.i(39834),K=a.i(9480),L=a.i(87394),M=a.i(51800),N=a.i(8385),O=a.i(61291),P="Radio",[Q,R]=(0,H.createContextScope)(P),[S,T]=Q(P),U=c.forwardRef((a,d)=>{let{__scopeRadio:e,name:f,checked:g=!1,required:h,disabled:i,value:j="on",onCheck:k,form:l,...m}=a,[n,o]=c.useState(null),p=(0,G.useComposedRefs)(d,a=>o(a)),q=c.useRef(!1),r=!n||l||!!n.closest("form");return(0,b.jsxs)(S,{scope:e,checked:g,disabled:i,children:[(0,b.jsx)(I.Primitive.button,{type:"button",role:"radio","aria-checked":g,"data-state":Y(g),"data-disabled":i?"":void 0,disabled:i,value:j,...m,ref:p,onClick:(0,F.composeEventHandlers)(a.onClick,a=>{g||k?.(),r&&(q.current=a.isPropagationStopped(),q.current||a.stopPropagation())})}),r&&(0,b.jsx)(X,{control:n,bubbles:!q.current,name:f,value:j,checked:g,required:h,disabled:i,form:l,style:{transform:"translateX(-100%)"}})]})});U.displayName=P;var V="RadioIndicator",W=c.forwardRef((a,c)=>{let{__scopeRadio:d,forceMount:e,...f}=a,g=T(V,d);return(0,b.jsx)(O.Presence,{present:e||g.checked,children:(0,b.jsx)(I.Primitive.span,{"data-state":Y(g.checked),"data-disabled":g.disabled?"":void 0,...f,ref:c})})});W.displayName=V;var X=c.forwardRef(({__scopeRadio:a,control:d,checked:e,bubbles:f=!0,...g},h)=>{let i=c.useRef(null),j=(0,G.useComposedRefs)(i,h),k=(0,N.usePrevious)(e),l=(0,M.useSize)(d);return c.useEffect(()=>{let a=i.current;if(!a)return;let b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(k!==e&&b){let c=new Event("click",{bubbles:f});b.call(a,e),a.dispatchEvent(c)}},[k,e,f]),(0,b.jsx)(I.Primitive.input,{type:"radio","aria-hidden":!0,defaultChecked:e,...g,tabIndex:-1,ref:j,style:{...g.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function Y(a){return a?"checked":"unchecked"}X.displayName="RadioBubbleInput";var Z=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],$="RadioGroup",[_,aa]=(0,H.createContextScope)($,[J.createRovingFocusGroupScope,R]),ab=(0,J.createRovingFocusGroupScope)(),ac=R(),[ad,ae]=_($),af=c.forwardRef((a,c)=>{let{__scopeRadioGroup:d,name:e,defaultValue:f,value:g,required:h=!1,disabled:i=!1,orientation:j,dir:k,loop:l=!0,onValueChange:m,...n}=a,o=ab(d),p=(0,L.useDirection)(k),[q,r]=(0,K.useControllableState)({prop:g,defaultProp:f??null,onChange:m,caller:$});return(0,b.jsx)(ad,{scope:d,name:e,required:h,disabled:i,value:q,onValueChange:r,children:(0,b.jsx)(J.Root,{asChild:!0,...o,orientation:j,dir:p,loop:l,children:(0,b.jsx)(I.Primitive.div,{role:"radiogroup","aria-required":h,"aria-orientation":j,"data-disabled":i?"":void 0,dir:p,...n,ref:c})})})});af.displayName=$;var ag="RadioGroupItem",ah=c.forwardRef((a,d)=>{let{__scopeRadioGroup:e,disabled:f,...g}=a,h=ae(ag,e),i=h.disabled||f,j=ab(e),k=ac(e),l=c.useRef(null),m=(0,G.useComposedRefs)(d,l),n=h.value===g.value,o=c.useRef(!1);return c.useEffect(()=>{let a=a=>{Z.includes(a.key)&&(o.current=!0)},b=()=>o.current=!1;return document.addEventListener("keydown",a),document.addEventListener("keyup",b),()=>{document.removeEventListener("keydown",a),document.removeEventListener("keyup",b)}},[]),(0,b.jsx)(J.Item,{asChild:!0,...j,focusable:!i,active:n,children:(0,b.jsx)(U,{disabled:i,required:h.required,checked:n,...k,...g,name:h.name,ref:m,onCheck:()=>h.onValueChange(g.value),onKeyDown:(0,F.composeEventHandlers)(a=>{"Enter"===a.key&&a.preventDefault()}),onFocus:(0,F.composeEventHandlers)(g.onFocus,()=>{o.current&&l.current?.click()})})})});ah.displayName=ag;var ai=c.forwardRef((a,c)=>{let{__scopeRadioGroup:d,...e}=a,f=ac(d);return(0,b.jsx)(W,{...f,...e,ref:c})});ai.displayName="RadioGroupIndicator";var aj=a.i(29965);let ak=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(af,{className:(0,i.cn)("grid gap-2",a),...c,ref:d}));ak.displayName=af.displayName;let al=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(ah,{ref:d,className:(0,i.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...c,children:(0,b.jsx)(ai,{className:"flex items-center justify-center",children:(0,b.jsx)(aj.Circle,{className:"h-2.5 w-2.5 fill-current text-current"})})}));al.displayName=ah.displayName;var am=a.i(42143),an=a.i(42731);let ao=a=>a?a.replace(/\\\\n\\\\n/g,"\n\n").replace(/\\\\n/g,"\n").replace(/\\n\\n/g,"\n\n").replace(/\\n/g,"\n"):a;function ap({content:a,metadata:c}){let{badge:d,title:e,subtitle:f}=a,g=c?.background==="gradient-blue"?"bg-gradient-to-r from-blue-600 to-blue-800":"bg-gradient-to-r from-gray-600 to-gray-800";return(0,b.jsxs)("div",{className:`${g} text-white rounded-lg p-8 mb-6`,children:[d&&(0,b.jsx)(y.Badge,{variant:"secondary",className:"mb-4 bg-white/20 text-white border-white/30",children:d}),(0,b.jsx)("h1",{className:"text-3xl font-bold mb-2",children:e}),f&&(0,b.jsx)("p",{className:"text-xl opacity-90",children:f})]})}function aq({content:a}){return(0,b.jsx)("div",{className:"prose prose-gray dark:prose-invert max-w-none mb-6",children:(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:ao(a.content).replace(/\n/g,"<br>")}})})}function ar({content:a,metadata:c}){let{title:d,description:f,items:g}=a;return(0,b.jsxs)(e.Card,{className:"mb-6",children:[(0,b.jsxs)(e.CardHeader,{children:[d&&(0,b.jsx)(e.CardTitle,{children:d}),f&&(0,b.jsx)("p",{className:"text-muted-foreground",children:f})]}),g&&(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"grid gap-4",children:g.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium",children:a.title}),a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.description})]})]},c))})})]})}function as({content:a,metadata:c}){let{src:d,alt:e,caption:f}=a;return(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("img",{src:d,alt:e||"",className:"w-full rounded-lg shadow-sm",loading:"lazy"}),f&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:f})]})}function at({content:a}){let{headers:c,rows:d}=a;return(0,b.jsx)("div",{className:"mb-6 overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full border-collapse border border-border",children:[(0,b.jsx)("thead",{children:(0,b.jsx)("tr",{className:"bg-muted",children:c.map((a,c)=>(0,b.jsx)("th",{className:"border border-border p-3 text-left font-medium",children:a},c))})}),(0,b.jsx)("tbody",{children:d.map((a,c)=>(0,b.jsx)("tr",{className:"hover:bg-muted/50",children:a.map((a,c)=>(0,b.jsx)("td",{className:"border border-border p-3",children:a},c))},c))})]})})}function au({content:a,metadata:c}){let{items:d,type:e="unordered"}=a;return(0,b.jsx)("div",{className:"mb-6",children:"ordered"===e?(0,b.jsx)("ol",{className:"list-decimal list-inside space-y-2",children:d.map((a,c)=>(0,b.jsx)("li",{className:"text-foreground",children:a},c))}):(0,b.jsx)("ul",{className:"list-disc list-inside space-y-2",children:d.map((a,c)=>(0,b.jsx)("li",{className:"text-foreground",children:a},c))})})}function av({content:a,metadata:c}){let{items:d,columns:f=2}=a;return(0,b.jsx)("div",{className:`grid ${3===f?"grid-cols-1 md:grid-cols-3":4===f?"grid-cols-1 md:grid-cols-2 lg:grid-cols-4":"grid-cols-1 md:grid-cols-2"} gap-4 mb-6`,children:d.map((a,c)=>(0,b.jsx)(e.Card,{className:"p-4",children:(0,b.jsxs)(e.CardContent,{className:"p-0",children:[a.title&&(0,b.jsx)("h4",{className:"font-medium mb-2",children:a.title}),a.content&&(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:ao(a.content).replace(/\n/g,"<br>")}})}),a.image&&(0,b.jsx)("img",{src:a.image,alt:a.title||"",className:"w-full rounded mt-2"})]})},c))})}function aw({content:a,metadata:c}){let{title:d,content:e}=a,f=c?.type||"info",g=()=>{switch(f){case"warning":return"text-yellow-800 dark:text-yellow-200";case"error":return"text-red-800 dark:text-red-200";case"success":return"text-green-800 dark:text-green-200";case"tip":return"text-blue-800 dark:text-blue-200";default:return"text-gray-800 dark:text-gray-200"}};return(0,b.jsx)("div",{className:`${(()=>{switch(f){case"warning":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800";case"error":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800";case"success":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800";case"tip":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800";default:return"bg-gray-50 dark:bg-gray-900/20 border-gray-200 dark:border-gray-800"}})()} border rounded-lg p-4 mb-6`,children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:`${g()} mt-0.5`,children:(()=>{switch(f){case"warning":return(0,b.jsx)(z.AlertTriangle,{className:"h-5 w-5"});case"error":return(0,b.jsx)(w,{className:"h-5 w-5"});case"success":return(0,b.jsx)(j.CheckCircle,{className:"h-5 w-5"});case"tip":return(0,b.jsx)(B,{className:"h-5 w-5"});default:return(0,b.jsx)(A,{className:"h-5 w-5"})}})()}),(0,b.jsxs)("div",{className:"flex-1",children:[d&&(0,b.jsx)("h4",{className:`font-medium ${g()} mb-2`,children:d}),(0,b.jsx)("div",{className:`${g()} whitespace-pre-line`,children:(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:ao(e).replace(/\n/g,"<br>")}})})]})]})})}function ax({content:a,metadata:c}){let{quote:d,author:e,title:f}=a;return(0,b.jsxs)("div",{className:"border-l-4 border-primary bg-muted/30 rounded-r-lg p-6 mb-6",children:[(0,b.jsxs)("blockquote",{className:"text-lg italic mb-4",children:['"',d,'"']}),e&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(C,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:e}),f&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:f})]})]})]})}function ay({metadata:a}){let c=a?.style||"default";return"dotted"===c?(0,b.jsx)("div",{className:"border-t-2 border-dotted border-border my-6"}):"thick"===c?(0,b.jsx)("div",{className:"border-t-4 border-border my-6"}):(0,b.jsx)("div",{className:"border-t border-border my-6"})}function az({content:a,metadata:c}){let{src:d,title:e,description:f}=a;return(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("div",{className:"relative w-full h-0 pb-[56.25%] bg-black rounded-lg overflow-hidden",children:(0,b.jsxs)("video",{className:"absolute top-0 left-0 w-full h-full",controls:!0,preload:"metadata",children:[(0,b.jsx)("source",{src:d,type:"video/mp4"}),"Your browser does not support the video tag."]})}),e&&(0,b.jsx)("h4",{className:"font-medium mt-2",children:e}),f&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:f})]})}function aA({content:a,metadata:c}){let{src:d,title:e,description:f}=a;return(0,b.jsxs)("div",{className:"mb-6 p-4 border rounded-lg",children:[(0,b.jsxs)("audio",{controls:!0,className:"w-full mb-2",children:[(0,b.jsx)("source",{src:d,type:"audio/mpeg"}),"Your browser does not support the audio tag."]}),e&&(0,b.jsx)("h4",{className:"font-medium",children:e}),f&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:f})]})}function aB({content:a,metadata:d,sectionId:e,onInteraction:g}){let{user:h}=(0,an.useAuth)(),{updateProgress:i}=function(a){let{user:b}=(0,an.useAuth)(),[d,e]=(0,c.useState)(null),[f,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(null);(0,c.useEffect)(()=>{(async()=>{if(!b?.id||!a)return g(!1);try{g(!0),i(null);let b=await fetch(`/api/quiz-questions?sectionId=${a}`);if(!b.ok)throw Error("Failed to fetch quiz questions");let c=await b.json();if(!c.success||!c.data){e({sectionId:a,totalQuestions:0,completedQuestions:0,correctAnswers:0,isCompleted:!1}),g(!1);return}let d=c.data,f=d.length,h=await fetch("/api/quiz-attempts");if(!h.ok){console.error("Failed to fetch quiz attempts:",h.status,h.statusText),e({sectionId:a,totalQuestions:f,completedQuestions:0,correctAnswers:0,isCompleted:!1}),g(!1);return}let j=await h.json();if(!j.success||!j.data){console.log("No quiz attempts found for user"),e({sectionId:a,totalQuestions:f,completedQuestions:0,correctAnswers:0,isCompleted:!1}),g(!1);return}let k=j.data,l=d.map(a=>a.id),m=new Map;k.forEach(a=>{if(l.includes(a.quizQuestionId)){let b=m.get(a.quizQuestionId);(!b||new Date(a.attemptedAt)>new Date(b.attemptedAt))&&m.set(a.quizQuestionId,a)}});let n=m.size,o=Array.from(m.values()).filter(a=>a.isCorrect).length,p=Array.from(m.values()).sort((a,b)=>new Date(b.attemptedAt).getTime()-new Date(a.attemptedAt).getTime())[0]?.attemptedAt;e({sectionId:a,totalQuestions:f,completedQuestions:n,correctAnswers:o,isCompleted:n===f&&f>0,lastAttemptAt:p})}catch(a){console.error("Error fetching knowledge check progress:",a),i(a instanceof Error?a.message:"Failed to fetch progress")}finally{g(!1)}})()},[b?.id,a]);let j=async()=>{b?.id&&a&&(g(!0),(async()=>{try{let b=await fetch(`/api/quiz-questions?sectionId=${a}`);if(!b.ok)return;let c=await b.json();if(!c.success||!c.data)return;let d=c.data,f=d.length,g=await fetch("/api/quiz-attempts");if(!g.ok)return void console.error("Failed to fetch quiz attempts in updateProgress:",g.status);let h=await g.json();if(!h.success||!h.data)return void console.log("No quiz attempts found for user in updateProgress");let i=h.data,j=d.map(a=>a.id),k=new Map;i.forEach(a=>{if(j.includes(a.quizQuestionId)){let b=k.get(a.quizQuestionId);(!b||new Date(a.attemptedAt)>new Date(b.attemptedAt))&&k.set(a.quizQuestionId,a)}});let l=k.size,m=Array.from(k.values()).filter(a=>a.isCorrect).length,n=Array.from(k.values()).sort((a,b)=>new Date(b.attemptedAt).getTime()-new Date(a.attemptedAt).getTime())[0]?.attemptedAt;e({sectionId:a,totalQuestions:f,completedQuestions:l,correctAnswers:m,isCompleted:l===f&&f>0,lastAttemptAt:n})}catch(a){console.error("Error updating progress:",a)}finally{g(!1)}})())};return{progress:d,loading:f,error:h,updateProgress:j,refetch:j}}(e),[k,l]=c.default.useState(""),[m,n]=c.default.useState(!1),[o,p]=c.default.useState(null),[q,r]=c.default.useState(0),[s,t]=c.default.useState(!1),{questionText:u,options:v,correctAnswer:w,explanation:x,quizQuestionId:y}=a,z="string"==typeof v?JSON.parse(v):v;c.default.useEffect(()=>{(async()=>{if(h?.id&&y)try{let a=await fetch(`/api/quiz-attempts?userId=${encodeURIComponent(h.id)}&quizQuestionId=${encodeURIComponent(y)}`);if(a.ok){let b=await a.json();if(b.success&&b.data.length>0){let a=b.data[0];l(a.user_answer),n(!0),p(a.is_correct),t(!0),r(b.data.length)}}}catch(a){console.error("Error loading quiz attempts:",a)}})()},[h?.id,y]);let A=async()=>{if(!k||!h?.id||!y)return;let b=w.split(",").map(a=>a.trim()).includes(k);p(b),n(!0),t(!0),r(a=>a+1);try{let c=await fetch("/api/quiz-attempts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:h.id,quizQuestionId:y,userAnswer:k,isCorrect:b,timeSpent:0})});c.ok&&(await c.json()).success&&(await i(),g&&g({blockId:a.id||"knowledge-check",interactionType:"click",metadata:{action:"submit_answer",isCorrect:b,attempts:q+1}}))}catch(a){console.error("Error recording quiz attempt:",a)}};return(0,b.jsxs)("div",{className:`${m&&null!==o?o?"border-green-200 bg-green-50 dark:bg-green-900/20":"border-red-200 bg-red-50 dark:bg-red-900/20":"border-blue-200 bg-blue-50 dark:bg-blue-900/20"} border rounded-lg p-6 mb-6`,children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,b.jsx)("div",{className:"text-blue-800 dark:text-blue-200 mt-0.5",children:(0,b.jsx)(B,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Knowledge Check"}),(0,b.jsx)("div",{className:"text-blue-800 dark:text-blue-200 text-sm leading-relaxed",children:(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:ao(u).replace(/\n/g,"<br>")}})})]})]}),(0,b.jsx)("div",{className:"space-y-3 mb-6",children:(0,b.jsx)(ak,{value:k,onValueChange:a=>{m||l(a)},disabled:m,className:"space-y-3",children:Object.entries(z).map(([a,c])=>(0,b.jsxs)("div",{className:(a=>{let b="flex items-center space-x-3 p-4 rounded-lg border transition-colors cursor-pointer";if(m){let c=w.split(",").map(a=>a.trim()).includes(a),d=k===a;c?b+=" border-green-300 bg-green-50 dark:bg-green-900/20":d&&!c?b+=" border-red-300 bg-red-50 dark:bg-red-900/20":b+=" border-gray-200 bg-gray-50 dark:bg-gray-900/20"}else k===a?b+=" border-primary bg-primary/5":b+=" border-border hover:border-primary/50";return b})(a),children:[(0,b.jsx)(al,{value:a,id:a,className:"flex-shrink-0"}),(0,b.jsx)(am.Label,{htmlFor:a,className:"flex-1 cursor-pointer font-normal",children:"string"==typeof c?c:`${a.toUpperCase()}. ${c}`}),m&&w.split(",").map(a=>a.trim()).includes(a)&&(0,b.jsx)(j.CheckCircle,{className:"h-5 w-5 text-green-500 flex-shrink-0"}),m&&k===a&&!w.split(",").map(a=>a.trim()).includes(a)&&(0,b.jsx)(E.XCircle,{className:"h-5 w-5 text-red-500 flex-shrink-0"})]},a))})}),s&&(0,b.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,b.jsxs)("div",{className:`p-4 rounded-lg ${o?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[o?(0,b.jsx)(j.CheckCircle,{className:"h-5 w-5 text-green-500"}):(0,b.jsx)(E.XCircle,{className:"h-5 w-5 text-red-500"}),(0,b.jsx)("span",{className:`font-medium ${o?"text-green-800 dark:text-green-200":"text-red-800 dark:text-red-200"}`,children:o?"Correct!":"Incorrect"})]}),!o&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-2",children:["The correct answer",w.includes(",")?"s are":" is",":"," ",(0,b.jsx)("span",{className:"font-medium",children:w.split(",").map(a=>z[a.trim()]).join(", ")})]})]}),x&&(0,b.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,b.jsx)("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Explanation"}),(0,b.jsx)("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:ao(x).replace(/\n/g,"<br>")}})})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-blue-200 dark:border-blue-800",children:[(0,b.jsx)("div",{className:"flex items-center gap-2",children:m&&!o&&(0,b.jsxs)(f.Button,{variant:"outline",onClick:()=>{l(""),n(!1),p(null),t(!1)},className:"flex items-center gap-2",children:[(0,b.jsx)(D,{className:"h-4 w-4"}),"Try Again"]})}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:m?(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:o?"Great job!":"Keep learning!"}):(0,b.jsx)(f.Button,{onClick:A,disabled:!k,className:"flex items-center gap-2",children:"Submit Answer"})})]})]})}function aC({block:a,sectionId:c,onInteraction:d}){return(0,b.jsx)("div",{className:"content-block","data-block-id":a.id,onMouseEnter:()=>{d&&d({blockId:a.id,interactionType:"view",metadata:void 0})},children:(()=>{switch(a.block_type){case"hero":return(0,b.jsx)(ap,{content:a.content,metadata:a.metadata});case"text":return(0,b.jsx)(aq,{content:a.content});case"card":return(0,b.jsx)(ar,{content:a.content,metadata:a.metadata});case"image":return(0,b.jsx)(as,{content:a.content,metadata:a.metadata});case"table":return(0,b.jsx)(at,{content:a.content});case"list":return(0,b.jsx)(au,{content:a.content,metadata:a.metadata});case"grid":return(0,b.jsx)(av,{content:a.content,metadata:a.metadata});case"callout":return(0,b.jsx)(aw,{content:a.content,metadata:a.metadata});case"quote":return(0,b.jsx)(ax,{content:a.content,metadata:a.metadata});case"divider":return(0,b.jsx)(ay,{metadata:a.metadata});case"video":return(0,b.jsx)(az,{content:a.content,metadata:a.metadata});case"audio":return(0,b.jsx)(aA,{content:a.content,metadata:a.metadata});case"knowledge-check":return(0,b.jsx)(aB,{content:a.content,metadata:a.metadata,sectionId:c,onInteraction:d});default:return(0,b.jsx)("div",{className:"mb-6 p-4 border border-dashed border-muted-foreground rounded-lg",children:(0,b.jsxs)("p",{className:"text-muted-foreground text-center",children:["Unsupported block type: ",a.block_type]})})}})()})}function aD(){let a=(0,d.useParams)(),h=(0,d.useRouter)(),{courses:i,loading:j}=(0,x.useCourses)(),k=a.slug,l=a.sectionId,p=i.find(a=>a.slug===k),{sections:q,loading:y,error:z}=function(a){let[b,d]=(0,c.useState)([]),[e,f]=(0,c.useState)(!0),[g,h]=(0,c.useState)(null);return(0,c.useEffect)(()=>{(async()=>{if(!a)return f(!1);try{f(!0),h(null);let b=await fetch(`/api/courses/${a}/sections`);if(!b.ok)throw Error(`Failed to fetch sections: ${b.statusText}`);let c=await b.json();if(!c.success)throw Error(c.error||"Failed to fetch sections");d(c.data||[])}catch(a){console.error("Error fetching course sections:",a),h(a instanceof Error?a.message:"Failed to fetch sections")}finally{f(!1)}})()},[a]),{sections:b,loading:e,error:g}}(k),{contentBlocks:A,loading:B,error:C}=function(a,b){let[d,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(null);return(0,c.useEffect)(()=>{(async()=>{if(!a||!b)return g(!1);try{g(!0),i(null);let c=await fetch(`/api/courses/${a}/sections/${b}/content`);if(!c.ok)throw Error(`Failed to fetch content blocks: ${c.statusText}`);let d=await c.json();if(!d.success)throw Error(d.error||"Failed to fetch content blocks");e(d.data||[])}catch(a){console.error("Error fetching content blocks:",a),i(a instanceof Error?a.message:"Failed to fetch content blocks")}finally{g(!1)}})()},[a,b]),{contentBlocks:d,loading:f,error:h}}(k,l),D=q.find(a=>a.id===l),E=q.findIndex(a=>a.id===l),F=c.useMemo(()=>q.map((a,b)=>({id:a.id,title:a.title,description:`Section ${b+1} of the ${p?.title||"course"}`,duration:"30 minutes",type:"reading",status:b<E?"completed":b===E?"in_progress":"available",progress:100*(b<E),href:`/courses/${k}/learn/${a.id}`})),[q,p,k,E]),G=c.useMemo(()=>{if(0===F.length)return 0;let a=F.filter(a=>"completed"===a.status).length,b=F.filter(a=>"in_progress"===a.status).length,c=F.length;return a/c*100+b/c*50},[F]);if(j||y||B)return(0,b.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,b.jsx)(v.Loader2,{className:"h-8 w-8 animate-spin text-primary-600"}),(0,b.jsx)("span",{className:"ml-3 text-neutral-600",children:"Loading course content..."})]});if(z||C)return(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(w,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2 text-neutral-900 dark:text-neutral-100",children:"Error Loading Course"}),(0,b.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400 mb-4",children:z||C}),(0,b.jsx)(f.Button,{onClick:()=>h.push("/courses"),children:"Back to Courses"})]});if(!p)return(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(s.BookOpen,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2 text-neutral-900 dark:text-neutral-100",children:"Course Not Found"}),(0,b.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400 mb-4",children:"The course you're looking for doesn't exist or has been removed."}),(0,b.jsx)(f.Button,{onClick:()=>h.push("/courses"),children:"Back to Courses"})]});if(!D)return(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(s.BookOpen,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2 text-neutral-900 dark:text-neutral-100",children:"Section Not Found"}),(0,b.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400 mb-4",children:"The section you're looking for doesn't exist or has been removed."}),(0,b.jsx)(f.Button,{onClick:()=>h.push(`/courses/${k}/learn`),children:"Back to Course"})]});if(0===A.length)return(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(s.BookOpen,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2 text-neutral-900 dark:text-neutral-100",children:"Content Coming Soon"}),(0,b.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400 mb-4",children:"This section doesn't have any content yet. Content is being prepared."}),(0,b.jsx)(f.Button,{onClick:()=>h.push(`/courses/${k}/learn`),children:"Back to Course"})]});let H=q[E+1],I=q[E-1];return(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsx)("div",{className:"sticky top-8",children:(0,b.jsx)(r,{courseTitle:p.title,modules:F,currentModuleId:D.id,overallProgress:G})})}),(0,b.jsxs)("div",{className:"lg:col-span-3 space-y-8",children:[(0,b.jsx)("div",{className:"flex items-center gap-4 mb-6",children:(0,b.jsxs)(f.Button,{variant:"ghost",size:"sm",onClick:()=>h.push(`/courses/${k}/learn`),className:"flex items-center gap-2",children:[(0,b.jsx)(t.ArrowLeft,{className:"h-4 w-4"}),"Back to Course"]})}),(0,b.jsxs)(e.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(m.PlayCircle,{className:"h-6 w-6 text-primary-600"}),(0,b.jsxs)("div",{children:[(0,b.jsx)(e.CardTitle,{className:"text-neutral-900 dark:text-neutral-100",children:D.title}),(0,b.jsxs)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mt-1",children:["Section ",E+1," of ",q.length," • Reading • 30 minutes"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-neutral-600 dark:text-neutral-400",children:[(0,b.jsx)(n.Clock,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"30 minutes remaining"})]})]})}),(0,b.jsxs)(e.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Section Progress"}),(0,b.jsx)("span",{className:"font-medium text-neutral-900 dark:text-neutral-100",children:"0%"})]}),(0,b.jsx)(g.Progress,{value:0,className:"h-2"})]}),(0,b.jsx)("div",{className:"space-y-6",children:A.map((a,c)=>(0,b.jsx)(aC,{block:a,sectionId:l,onInteraction:a=>{console.log("Content interaction:",a)}},a.id))}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-neutral-200 dark:border-neutral-700",children:[(0,b.jsxs)(f.Button,{variant:"outline",disabled:!I,onClick:()=>I&&h.push(`/courses/${k}/learn/${I.id}`),className:"flex items-center gap-2",children:[(0,b.jsx)(t.ArrowLeft,{className:"h-4 w-4"}),"Previous Section"]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(f.Button,{variant:"outline",className:"flex items-center gap-2",children:[(0,b.jsx)(o.FileText,{className:"h-4 w-4"}),"Take Notes"]}),(0,b.jsxs)(f.Button,{onClick:()=>H?h.push(`/courses/${k}/learn/${H.id}`):h.push(`/courses/${k}`),className:"flex items-center gap-2",children:[H?"Next Section":"Complete Course",(0,b.jsx)(u.ArrowRight,{className:"h-4 w-4"})]})]})]})]})]})]})]})}}];

//# sourceMappingURL=apps_safety-lms_src_app_courses_%5Bslug%5D_learn_%5BsectionId%5D_page_tsx_a4b0a4ff._.js.map